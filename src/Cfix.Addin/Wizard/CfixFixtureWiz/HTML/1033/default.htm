<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!--
	This file is part of cfix studio.
	
	Copyright 2009, Johannes Passing.
-->

<html DIR="LTR">
	<head>
		<title>Add Unit Test</title>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<link id="LINKURL" rel="stylesheet" href="styles.css">
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<meta http-equiv="MSThemeCompatible" content="Yes">
	
		<SYMBOL NAME="FIXTURE_NAME" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="FIXTURE_FILE" TYPE="text" VALUE=""></SYMBOL>
		<SYMBOL NAME="FIXTURE_APITYPE" TYPE="select-one" VALUE="cfixcc"></SYMBOL>
		<SYMBOL NAME="GENERATE_SETUP" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="GENERATE_TEARDOWN" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="GENERATE_BEFORE" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="GENERATE_AFTER" TYPE="checkbox" VALUE="false"></SYMBOL>
		
		<style>
			html 
			{
				overflow: hidden;
			}
			
			html, body 
			{
			    height: 100%;
            }
            
            table 
            {
                height: 100%; 
                width: 100%; 
            }
			
			#header
			{
				background-image: url('header.jpg');
		        background-repeat: no-repeat;
				height: 83px;
				color: white;
				font-weight: bold;
				padding-left: 20px;
			}
			
			#separator
			{
				height: 15px;
			}
			
			#body
			{
				padding: 10px;
			}
			
			#footer
			{
				height: 50px;
				text-align: right;
				padding-right: 10px;
			}
			
			button
			{
				width: 80px;
				margin-left: 3px;
			}
			
			.labels
			{
			}
			
			.inputsRow1
			{
			}
			
			.inputsRow1control
			{
				width: 185px;
			}
			
			.inputsRow2
			{
				height: 20px;
				padding-left: 20px;
			}
			
			#FinishBtn
			{
				right: 0;
			}
			
			#CancelBtn
			{
				right: 0;
			}
			
			.checkboxhelp
			{
				font-style: italic;
				color: #777777;
			}
		</style>
	</head>

	<body bgcolor="BUTTONFACE" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0" onload="InitDocument(document)" onkeydown="OnKey();" onkeypress="OnPress();">
		<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td id='header'>
				Add Unit Test
			</td>
		</tr>
		<tr>
			<td id='body' valign="top">
				<table width='100%'>
					<tr>
						<td class='labels'>
							<label for="FIXTURE_NAME" id="FIXTURE_NAME_LABEL" title="Enter the name for the fixture you want to add.">Fixture <u>n</u>ame:</label>
						</td>
						<td class='labels'>
							<label for="FIXTURE_APITYPE" id="FIXTURE_APITYPE_LABEL" title="Choose the API you wish to use.">A<u>P</u>I:</label>
						</td>
						<td class='labels'>
							<label for="FIXTURE_FILE" id="FIXTURE_FILE_LABEL" title="The generated name of the source file">.<u>c</u>pp/.c file:</LABEL>
						</td>
					</tr>
					<tr>
						<td class='inputsRow1'>
							<input class="inputsRow1control" id="FIXTURE_NAME" type="text" accesskey="n" title="Enter the name for the fixture you want to add." value="" onPropertyChange="OnFixtureNameChange();" tabindex="1">
						</td>
						<td class='inputsRow1'>
							<select class="inputsRow1control" id="FIXTURE_APITYPE" size="1" accesskey="p" title="Choose the API you wish to use." value="CC" tabindex="2" onPropertyChange="OnApiTypeChange();" >
								<option value="cfixcc">cfix C++ API</option>
								<option value="cfix">cfix C API</option>
								<option value="winunit">WinUnit API</option>
							</select>
						</td>
						<td class='inputsRow1'>
							<input class="inputsRow1control" id="FIXTURE_FILE" accesskey="c" title="The generated name of the source file" type="text" tabindex="3">
						</td>
					</tr>
				</table>
				
				<br />
				<br />
				Select which additional methods should be generated:
				
				<table width='100%'>
					<tr>
						<td class='inputsRow2'>
							<input class="checkbox" type="checkbox" ID="GENERATE_BEFORE" accesskey="b" TITLE="Generate a before method." TABINDEX="5">
							<div class="itemTextCheckboxA" >
								&nbsp;<label for="GENERATE_BEFORE" id="GENERATE_BEFORE_LABEL" TITLE="Generate a before method."><u>B</u>efore method</label>
								<span class='checkboxhelp'>The Before method runs before each test method&nbsp;</span>
							</div>
						</td>
					</tr>
					<tr>
						<td class='inputsRow2'>
							<input class="checkbox" type="checkbox" ID="GENERATE_AFTER" accesskey="a" TITLE="Generate an after method." TABINDEX="6">
							<div class="itemTextCheckboxA" >
								&nbsp;<label for="GENERATE_AFTER" id="GENERATE_AFTER_LABEL" TITLE="Generate a teardown method."><u>A</u>fter method</label>
								<span class='checkboxhelp'>The After method runs after each test method&nbsp;</span>
							</div>
						</td>
					</tr>
					<tr>
						<td class='inputsRow2'>
							<input class="checkbox" type="checkbox" ID="GENERATE_SETUP" accesskey="s" TITLE="Generate a setup method." TABINDEX="7">
							<div class="itemTextCheckboxA" >
								&nbsp;<label for="GENERATE_SETUP" id="GENERATE_SETUP_LABEL" TITLE="Generate a setup method."><u>S</u>etup method</label>
								<span class='checkboxhelp'>The Setup method runs once before the first test method&nbsp;</span>
							</div>
						</td>
					</tr>
					<tr>
						<td class='inputsRow2'>
							<input class="checkbox" type="checkbox" ID="GENERATE_TEARDOWN" accesskey="t" TITLE="Generate a teardown method." TABINDEX="8">
							<div class="itemTextCheckboxA" >
								&nbsp;<label for="GENERATE_TEARDOWN" id="GENERATE_TEARDOWN_LABEL" TITLE="Generate a teardown method."><u>T</u>eardown method</label>
								<span class='checkboxhelp'>The Teardown method runs once after the last test method&nbsp;</span>
							</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td id='separator'>
				<img src='pix.gif' height='1' width='100%' />
			</td>
		</tr>
		<tr>
			<td id='footer'>
				<button class="buttons" id="HelpBtn" accesskey="H" onClick=""><U>H</U>elp</button>
				<button id='FinishBtn' accesskey="F" onClick="OnFinish(document);"><U>F</U>inish</button>
				<button id='CancelBtn' accesskey="C" onClick="window.external.Finish(document, 'cancel');"><U>C</U>ancel</button>
			</td>
		</tr>	
		</table>
	</body>
</html>

<script language="jscript">

function UpdateFileName()
{
	var strClassName = FIXTURE_NAME.value;
	var strLen = strClassName.length;
	if ( strLen )
	{
		if ( FIXTURE_APITYPE.value == "cfix" )
		{
			extension = ".c";
		}
		else
		{
			extension = ".cpp";
		}

		safeClassName = CreateSafeName( strClassName );
		FIXTURE_FILE.value = safeClassName + extension;
		
		if ( safeClassName != strClassName )
		{
			FIXTURE_NAME.value = safeClassName;
		}
		
		FinishBtn.disabled = false;
	}
	else
	{
		FIXTURE_FILE.value = "";
		FinishBtn.disabled = true;
	}
}

function OnFixtureNameChange()
{
	UpdateFileName();
}

function OnApiTypeChange()
{
	UpdateFileName();
	
	GENERATE_SETUP.disabled = ( FIXTURE_APITYPE.value == "winunit" );
	GENERATE_TEARDOWN.disabled = ( FIXTURE_APITYPE.value == "winunit" );
}


function InitDocument( document )
{
	setDirection();
	
	if (window.external.FindSymbol( 'DOCUMENT_FIRST_LOAD' ) )
	{
		window.external.AddSymbol( "WIZARD_DIALOG_TITLE", "Add Unit Test Wizard" );
		window.external.SetDefaults(document);
	}

	window.external.Load( document );

	FinishBtn.disabled = true;
}

function OnFinish( document )
{
	OnWizFinish( document );
}

</script>
<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>
<script id="INCLUDE_COMMON" language="JSCRIPT"></script>


<script>
	var strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	strPath += "VCWizards/";
	strPath += window.external.GetHostLocale();
	var strScriptPath = strPath + "/Script.js";
	var strCommonPath = strPath + "/Common.js";
	document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
	document.scripts("INCLUDE_COMMON").src = strCommonPath;
</script>